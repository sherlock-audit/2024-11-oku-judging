Swift Charcoal Horse

High

# User can create 2 orders at the same timestamp overwriting the first


### Summary
user can create 2 orders first is small and second is big the second will overwrite the first having 2 big orders saved at `pendingOrderIds`
and only payed the right amount for the first
### Internal pre-conditions
not checking if `orderId` exist or not before creating order
### External pre-conditions

- user create 2 orders at the same timestamp

### Attack Path

1.  user create 2 orders at the same timestamp.
	1. note that `orderId` is generated by `recipient` and `block.timestamp` so creating 2 orders with the same as above here the second will overwrite the first.
2. first order user will specify as small amount as possible.
	1. `procureTokens(tokenIn, amountIn, recipient, permit, permitPayload);`
3. second order will user add amount he want to add and the amount will be taken from the user via `procureTokens`
4. orders get saved via `pendingOrderIds.push(orderId);`
5. now we have 2 orders having the last data passed to the `order`.

numerical ex:
1. user create order with amountIn=1.
2. user create 2nd order with amountIn = 100.
3. when calling `fillOrder` the only saved data is with amountIn = 100 for the second order
	- `fillOrder` could be called twice executing 2 orders with 100 stealing funds from the protocol

### Impact

Loss Of funds to the protocol
### PoC

N/A

### Mitigation

before creating order check if the `orderId` exist or not