High Cider Gorilla

Medium

# generateOrderId's current implementation can lead to duplicated OrderIDs

### Summary

The Id for an order is generated by encoding the sender address and the current block timestamp:

`solidity
       uint256 hashedValue = uint256(
            keccak256(abi.encodePacked(sender, block.timestamp))
        );
`

This implementation is however liable to create orders with the same Id in the event that more than one order is created for the same recipient in the same block.

### Root Cause

https://github.com/sherlock-audit/2024-11-oku/blob/ee3f781a73d65e33fb452c9a44eb1337c5cfdbd6/oku-custom-order-types/contracts/automatedTrigger/AutomationMaster.sol#L90

Failure to add a unique discriminator in the orderID generation function

### Internal pre-conditions

More than one order needs to be created for a recipient in a single block

### External pre-conditions

_No response_

### Attack Path

_No response_

### Impact

Orders can be unintentionally modified or cancelled.

### PoC

_No response_

### Mitigation

A possible solution is to consider adding a nonce to the generateOrderId function to ensure no two orders for the same sender have the same value